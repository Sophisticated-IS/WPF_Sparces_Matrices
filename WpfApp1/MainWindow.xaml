<<<<<<< HEAD
ï»¿<controls:MetroWindow
                          xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                          xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                          xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
                          xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
                          xmlns:controls="http://metro.mahapps.com/winfx/xaml/controls"
                          xmlns:col="clr-namespace:System.Collections;assembly=mscorlib"
                          xmlns:local="clr-namespace:Wpf_Matrices"
                          xmlns:dg2d="clr-namespace:DataGrid2DLibrary;assembly=DataGrid2DLibrary"
    xmlns:Converter="clr-namespace:WpfApp1"
    xmlns:dataGrid2D="http://gu.se/DataGrid2D"
    xmlns:sys="clr-namespace:System;assembly=mscorlib"
    x:Class="Wpf_Matrices.MainWindow"
    mc:Ignorable ="d"
                          Title="Ð Ð°Ð±Ð¾Ñ‚Ð°Ð¹ Ñ ÑƒÐ´Ð¾Ð²Ð¾Ð»ÑŒÑÑ‚Ð²Ð¸ÐµÐ¼ Ñ Fast_Matrix"
                          d:DesignHeight ="600"
                          d:DesignWidth="800"
                          Width="1000"
                          Height="600" Loaded="MetroWindow_Loaded" Closed="MetroWindow_Closed" Closing="MetroWindow_Closing"
                          >

    <controls:MetroWindow.Resources>

        <Converter:MatrixToDataViewConverter x:Key="MatrixToDataViewConverter"/>

        <ControlTemplate x:Key="ComboBoxToggleButton" TargetType="{x:Type ToggleButton}">
            <Grid x:Name="gd">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition />
                    <ColumnDefinition Width="25" />
                </Grid.ColumnDefinitions>
                <Border x:Name="Border" SnapsToDevicePixels="True" Grid.ColumnSpan="2" Background="White" BorderBrush="Black" BorderThickness="1"/>
                <Border x:Name="Boredr1" SnapsToDevicePixels="True" Grid.Column="1"  Margin="1" Background="LightGoldenrodYellow" BorderBrush="Black" BorderThickness="0,0,1,0" />
                <Path x:Name="Arrow" SnapsToDevicePixels="True" Grid.Column="1" Fill="#FFD4D040" HorizontalAlignment="Center" VerticalAlignment="Center" Data="M 0 0 L 6 6 L 12 0 Z"/>
                <ContentPresenter Grid.Column="0" TextElement.Foreground="Orange"/>
            </Grid>
            <ControlTemplate.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter TargetName="Border" Property="BorderBrush" Value="Black"/>
                    <Setter TargetName="Boredr1" Property="BorderBrush" Value="Black"/>
                </Trigger>
                <Trigger Property="IsChecked" Value="True">
                    <Setter TargetName="Arrow" Property="Data" Value="M 0 0 L 5 5 L 10 0"/>
                    <Setter TargetName="Arrow" Property="Fill" Value="White"/>
                    <Setter TargetName="Arrow" Property="Stroke" Value="White"/>
                    <Setter TargetName="Arrow" Property="StrokeThickness" Value="1.5"/>
                </Trigger>
                <Trigger Property="IsEnabled" Value="False">
                    <Setter TargetName="gd" Property="Visibility" Value="Visible"/>
                </Trigger>
            </ControlTemplate.Triggers>
        </ControlTemplate>

        <!--TextBox Template-->
        <ControlTemplate x:Key="ComboBoxTextBox" TargetType="{x:Type TextBox}">
            <ScrollViewer x:Name="PART_ContentHost" Focusable="False" />
        </ControlTemplate>

        <!--combobox-->
        <Style x:Key="combobox_style" TargetType="{x:Type ComboBox}">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate  TargetType="{x:Type ComboBox}">
                        <Grid>
                            <ToggleButton x:Name="ToggleButton" Foreground="Black" Template="{StaticResource ComboBoxToggleButton}" Focusable="false" IsChecked="{Binding IsDropDownOpen, Mode=TwoWay, RelativeSource={RelativeSource TemplatedParent}}" ClickMode="Press"/>
                            <ContentPresenter x:Name="ContentSite" IsHitTestVisible="False" Content="{TemplateBinding SelectionBoxItem}" ContentTemplate="{TemplateBinding SelectionBoxItemTemplate}" ContentTemplateSelector="{TemplateBinding ItemTemplateSelector}" Margin="3,3,23,3"  VerticalAlignment="Center" HorizontalAlignment="Left" />
                            <TextBox OverridesDefaultStyle="True" SelectionBrush="Gray" CaretBrush="Black" Margin="0,0,30,0" TextWrapping="NoWrap"   x:Name="PART_EditableTextBox" FontFamily="Segoe UI Dark"   Foreground="Black" Style="{x:Null}" Template="{StaticResource ComboBoxTextBox}" HorizontalAlignment="Left" Focusable="True"  VerticalAlignment="Center"  FontSize="15"   Visibility="Hidden" IsReadOnly="{TemplateBinding IsReadOnly}"/>
                            <Popup x:Name="Popup"  Grid.ColumnSpan="2" Placement="Bottom"  IsOpen="{TemplateBinding IsDropDownOpen}" AllowsTransparency="True" Focusable="False" PopupAnimation="Slide">
                                <Grid x:Name="DropDown"   SnapsToDevicePixels="True" MaxWidth="{TemplateBinding ActualWidth}" MinWidth="{TemplateBinding ActualWidth}" MaxHeight="{TemplateBinding MaxDropDownHeight}">
                                    <Border Grid.ColumnSpan="2" Grid.RowSpan="2" x:Name="DropDownBorder" SnapsToDevicePixels="True" Background="Transparent" MaxWidth="{TemplateBinding ActualWidth}" BorderThickness="1" BorderBrush="Black"/>
                                    <ScrollViewer Grid.ColumnSpan="2" ScrollViewer.CanContentScroll="False" Grid.Row="1" SnapsToDevicePixels="True">
                                        <StackPanel IsItemsHost="True" Background="Transparent"/>
                                    </ScrollViewer>
                                </Grid>
                            </Popup>
                        </Grid>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsEditable" Value="true">
                                <Setter Property="IsTabStop" Value="false"/>
                                <Setter  TargetName="PART_EditableTextBox" Property="Background" Value="White"/>
                                <Setter TargetName="PART_EditableTextBox" Property="Visibility" Value="Visible"/>
                                <Setter TargetName="PART_EditableTextBox" Property="Foreground" Value="Black"/>
                                <Setter TargetName="ContentSite" Property="Visibility" Value="Hidden"/>
                            </Trigger>
                            <Trigger Property="HasItems" Value="false">
                                <Setter TargetName="DropDownBorder" Property="MinHeight" Value="95"/>
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="false">
                                <Setter Property="IsTabStop" Value="false"/>
                                <Setter TargetName="PART_EditableTextBox" Property="Visibility" Value="Visible"/>
                                <Setter TargetName="PART_EditableTextBox" Property="Foreground" Value="Black"/>
                                <Setter  TargetName="PART_EditableTextBox" Property="IsEnabled" Value="False"/>
                                <Setter  TargetName="PART_EditableTextBox" Property="Background" Value="White"/>
                                <Setter TargetName="ContentSite" Property="Visibility" Value="Hidden"/>
                            </Trigger>
                            <Trigger Property="IsGrouping" Value="true">
                                <Setter Property="ScrollViewer.CanContentScroll" Value="false"/>
                            </Trigger>
                            <Trigger SourceName="Popup" Property="AllowsTransparency" Value="true">
                                <Setter TargetName="DropDownBorder" Property="Margin" Value="0,2,0,0"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

     


        <Style TargetType="{x:Type controls:MetroTabItem}" >
            <Style.Triggers>
                <Trigger Property="IsSelected" Value="True">
                    <Setter Property="Background" Value="#FFFFCF73"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <Style TargetType="{x:Type TabItem}" >
            <Setter Property="Background" Value="#FFFFCF73"/>
            <Setter Property="FontSize" Value="20"/>
            <Setter Property="FontWeight" Value="Bold"/>
        </Style>

        <LinearGradientBrush StartPoint="0,0" EndPoint="1,1" x:Key="ExpanderGradientbrush">
            <GradientStop Color="BlanchedAlmond" Offset="0"/>
            <GradientStop Color="Blue" Offset="0.2"/>
            <GradientStop Color="BlanchedAlmond" Offset="0.35"/>

            <GradientStop Color="White" Offset="0.65"/>
            <GradientStop Color="Blue" Offset="0.8"/>

            <GradientStop Color="BlanchedAlmond" Offset="1"/>
        </LinearGradientBrush>
    </controls:MetroWindow.Resources>


    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="47*"/>
            <ColumnDefinition Width="151*"/>
        </Grid.ColumnDefinitions>

        <controls:MetroTabControl BorderBrush="#FFFFBE40" BorderThickness="5" controls:TabControlHelper.UnderlineBrush="#FF4573D5" controls:ScrollViewerHelper.IsHorizontalScrollWheelEnabled="True" Grid.ColumnSpan="2" Margin="0,0,-0.4,0.4" >

            <controls:MetroTabItem    Header="Ð’Ñ‹Ñ‡Ð¸ÑÐ»ÐµÐ½Ð¸Ðµ Ð²Ñ‹Ñ€Ð°Ð¶ÐµÐ½Ð¸Ñ"  controls:TabControlHelper.UnderlineMouseOverSelectedBrush="#FF4573D5" >
                <Grid Background="#FF4573D5">

                    <Grid.RowDefinitions>
                        <RowDefinition Height="auto"/>
                        <RowDefinition/>
                    </Grid.RowDefinitions>
                    <Grid  Grid.Row="0" Background="#FF4573D5">
                        <Grid.RowDefinitions>
                            <RowDefinition/>
                            <RowDefinition/>

                        </Grid.RowDefinitions>
                        <Grid Grid.Row="0">
                            <DockPanel Margin="5" LastChildFill="True">
                                <!--<TextBlock Text="Ð’Ñ‹Ñ€Ð°Ð¶ÐµÐ½Ð¸Ðµ" FontSize="16" FontWeight="ExtraBlack" Foreground="Black" DockPanel.Dock="Top"/>-->
                                <Button BorderThickness="3" Content="=" FontSize="40" MinWidth="60" FontWeight="UltraBold" Foreground="#FFFFBE40" FontFamily="Arial" DockPanel.Dock="Right" Click="Button_Click_Compute_Expression" Background="#FF1C0772" BorderBrush="Black"/>
                                <Border BorderBrush="#FFFFBE40" BorderThickness="8">
                                    <TextBox Name="txtBox_Expression"  Padding="10" FontSize="20" FontWeight="UltraBlack" HorizontalContentAlignment="Center"
                                                  Background="White" BorderBrush="#FF110B0B"  CaretBrush="#FF050359" SelectionBrush="#FF2A85AE" Foreground="Black" MaxLength="100" MaxLines="1" IsUndoEnabled="True"  controls:TextBoxHelper.Watermark="Ð’Ð²ÐµÐ´Ð¸Ñ‚Ðµ Ð²Ñ‹Ñ€Ð°Ð¶ÐµÐ½Ð¸Ðµ:A+B"  TextAlignment="Center" controls:TextBoxHelper.WatermarkAlignment="Center" />
                                </Border>
                            </DockPanel>
                        </Grid>

                        <Grid Grid.Row="1">
                            <StackPanel>
                                <!--<TextBlock Padding="0,0,0,3" HorizontalAlignment="Left" FontSize="14"><Run Foreground="Green" Text="âœ…"/><Run Text=" "/><Run FontWeight="DemiBold" Text="ÐžÑˆÐ¸Ð±Ð¾Ðº ÐÐ•Ð¢"/>-->


                                <controls:MetroAnimatedSingleRowTabControl FontFamily="times new roman" Margin="0,0,0,3"  >
                                    <TabItem  Header="Ð’Ñ‹Ð±Ð¾Ñ€ Ð¼Ð°Ñ‚Ñ€Ð¸Ñ†Ñ‹" ToolTip="ÐŸÐ¾Ð¸ÑÐº ÑÑƒÑ‰ÐµÑÑ‚Ð²ÑƒÑŽÑ‰ÐµÐ¹ Ð¼Ð°Ñ‚Ñ€Ð¸Ñ†Ñ‹ Ð´Ð»Ñ Ð¿Ñ€Ð¾ÑÐ¼Ð¾Ñ‚Ñ€Ð°" >
                                        <Border  BorderThickness="3" BorderBrush="#FFFFBE40" Background="#FFFFBE40">
                                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Stretch" VerticalAlignment="Center">
                                                <ComboBox x:Name="ComboBox_orientation" ToolTip="Ð—Ð´ÐµÑÑŒ Ð¼Ð¾Ð¶Ð½Ð¾ Ð²Ñ‹Ð±Ñ€Ð°Ñ‚ÑŒ Ð¾Ñ€Ð¸ÐµÐ½Ñ‚Ð°Ñ†Ð¸ÑŽ" Style="{StaticResource combobox_style}"  MinHeight="50" MinWidth="100" Background="AliceBlue" Margin="5" Foreground="Black" FontSize="16" SelectionChanged="ComboBox_orientation_SelectionChanged" controls:TextBoxHelper.Watermark="sdfsdfsd">
                                                    <ComboBoxItem Content="ÐžÑ€Ð¸ÐµÐ½Ñ‚Ð°Ñ†Ð¸Ñ" FontStyle="Italic" Visibility="Collapsed"/>

                                                    <ComboBoxItem>
                                                        <Image Source="Images\Orientations(minsize) for comboBox\OP2.png"/>
                                                    </ComboBoxItem>
                                                    <ComboBoxItem>
                                                        <Image Source="Images\Orientations(minsize) for comboBox\ÐžÐ .png"/>
                                                    </ComboBoxItem>

                                                    <ComboBoxItem>
                                                        <Image Source="Images\Orientations(minsize) for comboBox\OP4.png"/>
                                                    </ComboBoxItem>

                                                    <ComboBoxItem>
                                                        <Image Source="Images\Orientations(minsize) for comboBox\OP3.png"/>
                                                    </ComboBoxItem>

                                                </ComboBox>

                                                <ComboBox x:Name="ComboBox_common_elts" ToolTip="Ð—Ð´ÐµÑÑŒ Ð¼Ð¾Ð¶Ð½Ð¾ Ð²Ñ‹Ð±Ñ€Ð°Ñ‚ÑŒ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ Ð¾Ð´Ð½Ð¾Ñ‚Ð¸Ð¿Ð½Ð¾Ð³Ð¾ ÑÐ»ÐµÐ¼ÐµÐ½Ñ‚Ð°" Style="{StaticResource combobox_style}" MinHeight="50" MinWidth="100" Background="AliceBlue" Margin="5" Foreground="Black" FontSize="16" SelectionChanged="ComboBox_common_elts_SelectionChanged">
                                                    <ComboBoxItem Content="Ð—Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ Ð¾Ð´Ð½Ð¾Ñ‚Ð¸Ð¿Ð½Ñ‹Ñ… ÑÐ»ÐµÐ¼ÐµÐ½Ñ‚Ð¾Ð²" Foreground="Gray" FontStyle="Italic" Visibility="Collapsed"/>
                                                </ComboBox>

                                                <ComboBox x:Name="comboBox_name" ToolTip="Ð—Ð´ÐµÑÑŒ Ð¼Ð¾Ð¶Ð½Ð¾ Ð²Ñ‹Ð±Ñ€Ð°Ñ‚ÑŒ Ð¸Ð¼Ñ Ð¼Ð°Ñ‚Ñ€Ð¸Ñ†Ð°, ÐºÐ¾Ñ‚Ð¾Ñ€Ð°Ñ Ð·Ð°Ð³Ñ€ÑƒÐ·Ð¸Ñ‚ÑÑ ÑÑ€Ð°Ð·Ñƒ Ð¶Ðµ Ð´Ð»Ñ Ð¿Ñ€Ð¾ÑÐ¼Ð¾Ñ‚Ñ€Ð°" Style="{StaticResource combobox_style}" MinHeight="50" MinWidth="100" Background="AliceBlue" Margin="5" Foreground="Black" FontSize="16" SelectionChanged="comboBox_name_SelectionChanged">
                                                    <ComboBoxItem Content="ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ðµ" FontStyle="Italic" Visibility="Collapsed"/>

                                                </ComboBox>
                                            </StackPanel>
                                        </Border>
                                    </TabItem>


                                    <TabItem Header="Ð˜ÑÑ‚Ð¾Ñ€Ð¸Ñ Ð²Ñ‹Ñ€Ð°Ð¶ÐµÐ½Ð¸Ð¹" ToolTip="Ð—Ð´ÐµÑÑŒ Ð²Ñ‹ Ð¼Ð¾Ð¶ÐµÑ‚Ðµ ÑƒÐ²Ð¸Ð´ÐµÑ‚ÑŒ Ð¸ÑÑ‚Ð¾Ñ€Ð¸ÑŽ Ð²Ð°ÑˆÐ¸Ñ… Ð²Ñ‹Ñ€Ð°Ð¶ÐµÐ½Ð¸Ð¹" >
                                        <DataGrid FontSize="14" FontWeight="Bold" HorizontalAlignment="Left" HorizontalContentAlignment="Left" FontFamily="arial" MaxHeight="100" MinWidth="575" x:Name="DG_Expressions" AutoGenerateColumns="False"  Background="White" BorderBrush="#CCFFFFFF" OpacityMask="#FF21CEA6" >
                                            <!--<ScrollViewer>
                                                <ScrollViewer.Resources>
                                                    <sys:Double x:Key="{x:Static SystemParameters.VerticalScrollBarWidthKey}">100</sys:Double>
                                                </ScrollViewer.Resources>
                                            </ScrollViewer>-->
                                            <DataGrid.Columns>
                                                <DataGridTextColumn Binding="{Binding Number}" Header="â„–" IsReadOnly="True"/>
                                                <DataGridTextColumn Binding="{Binding Expression}" Header="Ð’Ñ‹Ñ€Ð°Ð¶ÐµÐ½Ð¸Ðµ" IsReadOnly="True"/>

                                            </DataGrid.Columns>

                                        </DataGrid>
                                    </TabItem>
                                    <TabItem Header="Ð”Ð¾Ð¿ÑƒÑÑ‚Ð¸Ð¼Ñ‹Ðµ Ð¾Ð¿ÐµÑ€Ð°Ñ†Ð¸Ð¸">
                                        <UniformGrid Columns="4" Rows="1"  VerticalAlignment="Bottom" HorizontalAlignment="Center">
                                            <Button ToolTip="Ð¡Ð»Ð¾Ð¶ÐµÐ½Ð¸Ðµ Ð´Ð²ÑƒÑ… Ð¼Ð°Ñ‚Ñ€Ð¸Ñ†"  Content="âž•"  MaxHeight="400" MaxWidth="400" FontSize="25" BorderBrush="Black" Background="#FFFFBE40" FontWeight="Bold" Click="Button_Click_plus"/>
                                            <Button ToolTip="ÐŸÐ¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ðµ Ð¾Ð±Ñ€Ð°Ñ‚Ð½Ð¾Ð¹ Ð¼Ð°Ñ‚Ñ€Ð¸Ñ†Ñ‹" Content="~" MaxHeight="400" MaxWidth="400" FontSize="25" BorderBrush="Black"  Background="#FFFFBE40"   FontWeight="Bold" Click="Button_Click_inverse"/>
                                            <Button ToolTip="Ð£Ð¼Ð½Ð¾Ð¶ÐµÐ½Ð¸Ðµ Ð´Ð²ÑƒÑ… Ð¼Ð°Ñ‚Ñ€Ð¸Ñ†" Content="âœ•"   MaxHeight="400" MaxWidth="400" FontSize="25" BorderBrush="Black"  Background="#FFFFBE40"  FontWeight="Bold" Click="Button_Click_multiple"/>
                                            <Button ToolTip="Ð’Ñ‹Ñ‡Ð¸Ñ‚Ð°Ð½Ð¸Ðµ Ð´Ð²ÑƒÑ… Ð¼Ð°Ñ‚Ñ€Ð¸Ñ†"  Content="âž–"  MaxHeight="400" MaxWidth="400" FontSize="25" BorderBrush="Black" Background="#FFFFBE40"  FontWeight="Bold" Click="Button_Click_minus"/>
                                        </UniformGrid>
                                    </TabItem>
                                </controls:MetroAnimatedSingleRowTabControl>
                            </StackPanel>
                        </Grid>

                    </Grid>

                    <Grid Grid.Row="1">

                        <Grid.ColumnDefinitions>
                            <ColumnDefinition  Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="auto" />
                            <RowDefinition/>
                        </Grid.RowDefinitions>

                        <Grid   Grid.Row ="0" >
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="1*"/>
                                <ColumnDefinition Width="auto"/>
                                <ColumnDefinition Width="1*"/>

                            </Grid.ColumnDefinitions>

                            <Grid Grid.Column="1">

                                <TextBlock Name="Matrix_name_1st_page"   HorizontalAlignment="Center" VerticalAlignment="Center"  FontSize="28" FontWeight="DemiBold" ><Run Text="Ð—Ð´ÐµÑÑŒ Ð¾Ñ‚Ð¾Ð±Ñ€Ð°Ð·Ð¸Ñ‚ÑÑ Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚ Ð²Ñ‹Ñ‡Ð¸ÑÐ»ÐµÐ½Ð¸Ð¹"/></TextBlock>
                            </Grid>
                            <Grid Grid.Column="2" HorizontalAlignment="Right" Margin="0,0,15,0" >

                                <Button MinWidth="10" Content="ðŸ“‚" FontStretch="UltraCondensed"  ToolTip="Ð¡Ð¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ðµ Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ð°"
                                        FontSize="25" FontWeight="Bold" Background="#FFFFCF73"
                                        Click="Save_Matrix_Dialog" AutomationProperties.IsRequiredForForm="True"/>

                            </Grid>

                        </Grid>

                        <Grid Grid.Row="1">
                            <dg2d:DataGrid2D x:Name="dataGrid2D" FontSize="20" VerticalScrollBarVisibility="Auto" IsReadOnly="True" 
                                             ItemsSource2D="{Binding m_intArray}" Background="#FF4573D5" EnableColumnVirtualization="True" 
                                              UseModifiedDataGridStyle="True" RowBackground="White" AlternatingRowBackground="#ebebeb"  IsManipulationEnabled="True" CanUserReorderColumns="False" CanUserSortColumns="False" MinColumnWidth="100" />

                        </Grid>
                    </Grid>

                </Grid>

            </controls:MetroTabItem>

            <controls:MetroTabItem Header="Ð”Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ Ð¼Ð°Ñ‚Ñ€Ð¸Ñ†Ñ‹" Margin="5,0,0,0 "  >
                <Grid   Background="#FF4573D5">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="auto"/>
                        <ColumnDefinition />
                        <ColumnDefinition Width="auto"/>
                    </Grid.ColumnDefinitions>
                    <Grid Grid.Column="0" MaxWidth="400">
                        <Expander IsExpanded="True" ExpandDirection="Right" BorderThickness="3" Background="{StaticResource ExpanderGradientbrush}" BorderBrush="#FFFFBE40">
                            <Expander.Header>
                                <Label Content="Ð¥Ð°Ñ€Ð°ÐºÑ‚ÐµÑ€Ð¸ÑÑ‚Ð¸ÐºÐ¸ Ð¼Ð°Ñ‚Ñ€Ð¸Ñ†Ñ‹" VerticalAlignment="Center" FontWeight="Bold" FontSize="20" Foreground="Black">
                                    <Label.LayoutTransform>
                                        <RotateTransform Angle="270"/>
                                    </Label.LayoutTransform>
                                </Label>
                            </Expander.Header>

                            <StackPanel>
                                <StackPanel>
                                    <TextBlock Text="Ð ÐµÐ´Ð°ÐºÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ" HorizontalAlignment="Center" FontSize="25" FontWeight="Bold"/>
                                    <Border BorderBrush="Gray" BorderThickness="3">
                                        <StackPanel>
                                            <TextBlock Text="Ð Ð°Ð·Ð¼ÐµÑ€" FontSize="18" FontWeight="Bold"/>
                                            <controls:NumericUpDown x:Name="NumericUpDown" Value="50" FontSize="20" NumericInputMode="Numbers" TrackMouseWheelWhenMouseOver="True" Maximum="100000" Minimum="1" />
                                            <Button Content="Ð¡Ð¾Ð·Ð´Ð°Ñ‚ÑŒ Ð¼Ð°Ñ‚Ñ€Ð¸Ñ†Ñƒ" FontSize="20" FontWeight="Bold" Background="#D2691E" Click="Button_Click_Create_Matrix"/>
                                            <StackPanel Orientation="Horizontal">
                                                <TextBlock Text="ÐžÑ€Ð¸ÐµÐ½Ñ‚Ð°Ñ†Ð¸Ñ:" FontSize="18" FontWeight="Bold" />
                                                <Button Name="Button_Orientation_chnge" Margin="5,5,0,0" Click="Button_Orientation_Click">
                                                    <Image  x:Name="Image_OR" Width="50"/>
                                                </Button>
                                            </StackPanel>
                                            <TextBlock Text="Ð—Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ Ð¾Ð´Ð½Ð¾Ñ‚Ð¸Ð¿Ð½Ñ‹Ñ… ÑÐ»ÐµÐ¼ÐµÐ½Ñ‚Ð¾Ð²:" FontSize="18" FontWeight="Bold"/>
                                            <TextBox x:Name="textBox_typical_elt" Text="0" FontSize="20" MaxLength="50" PreviewTextInput="TextBox_PreviewTextInput" MouseLeave="textBox_typical_elt_MouseLeave" />

                                        </StackPanel>
                                    </Border>
                                </StackPanel>
                                <Border Margin="0,3,0,0" BorderBrush="Gray" BorderThickness="3">
                                    <StackPanel>
                                        <Button Content="ÐÐ²Ñ‚Ð¾ Ð·Ð°Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ðµ" FontSize="20" Background="#FFFFBE40" Click="Button_Click_Auto_Fill"/>
                                        <Button Content="Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ Ð¼Ð°Ñ‚Ñ€Ð¸Ñ†Ñƒ" FontSize="20"  Background="#FFBF7930" Click="Button_Click_Add_To_List"/>
                                        <Button  Content="ÐžÑ‚ÐºÑ€Ñ‹Ñ‚ÑŒ ÑƒÐ¶Ðµ ÑÑƒÑ‰ÐµÑÑ‚Ð²ÑƒÑŽÑ‰ÑƒÑŽ" FontSize="20" Background="#FFFFBE40" Click="Button_Open_existing_Matrix_Click"/>
                                        <Button Content="Ð¡Ð¾Ñ…Ñ€Ð°Ð½Ð¸Ñ‚ÑŒ ÐºÐ°Ðº" FontSize="20" Background="#FFBF7930" Click="Button_save_as_left_expander_Click"/>
                                        <Button Content="Ð£Ð´Ð°Ð»Ð¸Ñ‚ÑŒ Ð¸Ð· ÑÐ¿Ð¸ÑÐºÐ°" FontSize="20" Background="#FFFFBE40" Click="Button_Click_delete_from_Matrix_List"/>

                                    </StackPanel>
                                </Border>
                            </StackPanel>
                        </Expander>
                    </Grid>

                    <Grid Grid.Column="1">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="auto"/>
                            <RowDefinition/>
                            <RowDefinition Height="auto"/>
                        </Grid.RowDefinitions>

                        <Grid Grid.Row="0">
                            <TextBlock Name="Label_Matrix_Name" Text="Ð¡ÐžÐ—Ð”ÐÐ™Ð¢Ð• Ð¸Ð»Ð¸ Ð’Ð«Ð‘Ð•Ð Ð˜Ð¢Ð• Ð¼Ð°Ñ‚Ñ€Ð¸Ñ†Ñƒ" HorizontalAlignment="Center" VerticalAlignment="Center" FontSize="25" FontWeight="ExtraBold"/>
                        </Grid>
                        <Grid Grid.Row="1" >
                            <dg2d:DataGrid2D MinWidth="50" x:Name="dataGrid2D_sec_page" FontSize="20" VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Auto" BorderThickness="0"
                                                 VerticalGridLinesBrush="Black" HorizontalGridLinesBrush="Black" 
                                             Foreground="Black" Background="#FF4573D5" dataGrid2D:Index.StartAt="0"
                                             UseModifiedDataGridStyle="True" RowBackground="White" AlternatingRowBackground="#ebebeb"  EnableColumnVirtualization="True" IsSynchronizedWithCurrentItem="True" AutomationProperties.IsRequiredForForm="True" CanUserReorderColumns="False" CanUserSortColumns="False" MinColumnWidth="100" ClipboardCopyMode="None" ItemStringFormat="" KeyDown="dataGrid2D_sec_page_KeyDown" />
                            <!--<DataGrid >
                                <DataGrid.ItemsSource >
                                    <MultiBinding    Converter="{StaticResource MatrixToDataViewConverter}">
                                        <Binding Path="ColumnHeaders"/>
                                        <Binding Path="RowHeaders"/>
                                        <Binding Path="Values"/>
                                    </MultiBinding>
                                </DataGrid.ItemsSource>
                            </DataGrid>-->
                        </Grid>
                        <Grid Grid.Row="2" Background="#FFFFCF73">

                            <StackPanel  Orientation="Horizontal"  >
                                <TextBlock  Margin="0,0,3,0" FontWeight="Bold" FontSize="20"  Text="ÐŸÑ€ÐµÐ´ÑÑ‚Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ:"/>
                                <controls:MetroAnimatedSingleRowTabControl BorderThickness="0" Background="White">
                                    <TabItem Name="TabItem_Normal_Form" Header="ÐžÐ±Ñ‹Ñ‡Ð½Ð¾Ðµ"  FontSize="19"  controls:ControlsHelper.HeaderFontSize="10" controls:ControlsHelper.HeaderFontWeight="Bold" Background="#FFFFCF73" GotFocus="TabItem_GotFocus_Matrix_Form" />
                                    <TabItem Name="TabItem_Dense_Form" Header="Ð£Ð¿Ð°ÐºÐ¾Ð²Ð°Ð½Ð½Ð¾Ðµ" controls:ControlsHelper.HeaderFontSize="10" controls:ControlsHelper.HeaderFontWeight="Bold" GotFocus="TabItem_GotFocus_Dense_Form"/>
                                    <!--<TabItem Header="Ð¡ Ð°Ð´Ñ€ÐµÑÐ°Ð¼Ð¸" controls:ControlsHelper.HeaderFontSize="10" controls:ControlsHelper.HeaderFontWeight="Bold" PreviewMouseDown="TabItem_PreviewMouseDown_Addresses" GotFocus="TabItem_GotFocus"/>-->
                                </controls:MetroAnimatedSingleRowTabControl>
                            </StackPanel>
                        </Grid>
                    </Grid>

                    <Grid Grid.Column="2" MaxWidth="250">
                        <Expander ExpandDirection="Left" IsExpanded="True" BorderThickness="3" Background="{StaticResource ExpanderGradientbrush}" Foreground="Black" BorderBrush="#FFFFBE40" controls:ScrollViewerHelper.IsHorizontalScrollWheelEnabled="True" Margin="0,0,0,-0.4">
                            <Expander.Header>
                                <Label Content="Ð’Ñ‹Ð±Ð¾Ñ€ Ð¼Ð°Ñ‚Ñ€Ð¸Ñ†Ñ‹" VerticalAlignment="Center" FontSize="20" FontWeight="Bold" Foreground="Black">
                                    <Label.LayoutTransform>
                                        <RotateTransform Angle="90"/>
                                    </Label.LayoutTransform>
                                </Label>
                            </Expander.Header>

                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="AUTO"/>
                                    <RowDefinition/>
                                </Grid.RowDefinitions>
                                <Grid Grid.Row="0">
                                    <TextBox Name="text_box_search" TextWrapping="NoWrap" controls:TextBoxHelper.Watermark="ðŸ”Ž ÐŸÐ¾Ð¸ÑÐº Ð¼Ð°Ñ‚Ñ€Ð¸Ñ†Ñ‹" FontSize="16" SelectionBrush="#FF4573D5" TextChanged="TextBox_TextChanged" MaxLines="1" MaxLength="100" IsUndoEnabled="False"/>

                                </Grid>
                                <Grid Grid.Row="1">
                                    <ListView IsTextSearchEnabled="True"  VerticalContentAlignment="Top" Name="List_Matrices" FontSize="16" OverridesDefaultStyle="False" 
                                               FontWeight="Bold" HorizontalAlignment="Stretch" MouseDoubleClick="List_Matrices_MouseDoubleClick"/>
                                </Grid>

                                <!--<ListBox ScrollViewer.CanContentScroll="False" ScrollViewer.VerticalScrollBarVisibility="Visible" Name="List_Box">
                                </ListBox>-->
                                <!--<ItemsPresenter />-->
                            </Grid>
                            <!--</ListView>-->




                        </Expander>
                    </Grid>





                </Grid>
            </controls:MetroTabItem>

        </controls:MetroTabControl>



    </Grid>



</controls:MetroWindow>
=======
ï»¿<controls:MetroWindow
                          xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                          xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                          xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
                          xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
                          xmlns:controls="http://metro.mahapps.com/winfx/xaml/controls"
                          xmlns:col="clr-namespace:System.Collections;assembly=mscorlib"
                          xmlns:local="clr-namespace:Wpf_Matrices"
                          xmlns:dg2d="clr-namespace:DataGrid2DLibrary;assembly=DataGrid2DLibrary"
    xmlns:Converter="clr-namespace:WpfApp1"
    xmlns:dataGrid2D="http://gu.se/DataGrid2D"
    xmlns:sys="clr-namespace:System;assembly=mscorlib"
    x:Class="Wpf_Matrices.MainWindow"
    mc:Ignorable ="d"
                          Title="Ð Ð°Ð±Ð¾Ñ‚Ð°Ð¹ Ñ ÑƒÐ´Ð¾Ð²Ð¾Ð»ÑŒÑÑ‚Ð²Ð¸ÐµÐ¼ Ñ Fast_Matrix"
                          d:DesignHeight ="600"
                          d:DesignWidth="800"
                          Width="1000"
                          Height="600" Loaded="MetroWindow_Loaded" Closed="MetroWindow_Closed" Closing="MetroWindow_Closing"
                          >

    <controls:MetroWindow.Resources>

        <Converter:MatrixToDataViewConverter x:Key="MatrixToDataViewConverter"/>

        <ControlTemplate x:Key="ComboBoxToggleButton" TargetType="{x:Type ToggleButton}">
            <Grid x:Name="gd">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition />
                    <ColumnDefinition Width="25" />
                </Grid.ColumnDefinitions>
                <Border x:Name="Border" SnapsToDevicePixels="True" Grid.ColumnSpan="2" Background="White" BorderBrush="Black" BorderThickness="1"/>
                <Border x:Name="Boredr1" SnapsToDevicePixels="True" Grid.Column="1"  Margin="1" Background="LightGoldenrodYellow" BorderBrush="Black" BorderThickness="0,0,1,0" />
                <Path x:Name="Arrow" SnapsToDevicePixels="True" Grid.Column="1" Fill="#FFD4D040" HorizontalAlignment="Center" VerticalAlignment="Center" Data="M 0 0 L 6 6 L 12 0 Z"/>
                <ContentPresenter Grid.Column="0" TextElement.Foreground="Orange"/>
            </Grid>
            <ControlTemplate.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter TargetName="Border" Property="BorderBrush" Value="Black"/>
                    <Setter TargetName="Boredr1" Property="BorderBrush" Value="Black"/>
                </Trigger>
                <Trigger Property="IsChecked" Value="True">
                    <Setter TargetName="Arrow" Property="Data" Value="M 0 0 L 5 5 L 10 0"/>
                    <Setter TargetName="Arrow" Property="Fill" Value="White"/>
                    <Setter TargetName="Arrow" Property="Stroke" Value="White"/>
                    <Setter TargetName="Arrow" Property="StrokeThickness" Value="1.5"/>
                </Trigger>
                <Trigger Property="IsEnabled" Value="False">
                    <Setter TargetName="gd" Property="Visibility" Value="Visible"/>
                </Trigger>
            </ControlTemplate.Triggers>
        </ControlTemplate>

        <!--TextBox Template-->
        <ControlTemplate x:Key="ComboBoxTextBox" TargetType="{x:Type TextBox}">
            <ScrollViewer x:Name="PART_ContentHost" Focusable="False" />
        </ControlTemplate>

        <!--combobox-->
        <Style x:Key="combobox_style" TargetType="{x:Type ComboBox}">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate  TargetType="{x:Type ComboBox}">
                        <Grid>
                            <ToggleButton x:Name="ToggleButton" Foreground="Black" Template="{StaticResource ComboBoxToggleButton}" Focusable="false" IsChecked="{Binding IsDropDownOpen, Mode=TwoWay, RelativeSource={RelativeSource TemplatedParent}}" ClickMode="Press"/>
                            <ContentPresenter x:Name="ContentSite" IsHitTestVisible="False" Content="{TemplateBinding SelectionBoxItem}" ContentTemplate="{TemplateBinding SelectionBoxItemTemplate}" ContentTemplateSelector="{TemplateBinding ItemTemplateSelector}" Margin="3,3,23,3"  VerticalAlignment="Center" HorizontalAlignment="Left" />
                            <TextBox OverridesDefaultStyle="True" SelectionBrush="Gray" CaretBrush="Black" Margin="0,0,30,0" TextWrapping="NoWrap"   x:Name="PART_EditableTextBox" FontFamily="Segoe UI Dark"   Foreground="Black" Style="{x:Null}" Template="{StaticResource ComboBoxTextBox}" HorizontalAlignment="Left" Focusable="True"  VerticalAlignment="Center"  FontSize="15"   Visibility="Hidden" IsReadOnly="{TemplateBinding IsReadOnly}"/>
                            <Popup x:Name="Popup"  Grid.ColumnSpan="2" Placement="Bottom"  IsOpen="{TemplateBinding IsDropDownOpen}" AllowsTransparency="True" Focusable="False" PopupAnimation="Slide">
                                <Grid x:Name="DropDown"   SnapsToDevicePixels="True" MaxWidth="{TemplateBinding ActualWidth}" MinWidth="{TemplateBinding ActualWidth}" MaxHeight="{TemplateBinding MaxDropDownHeight}">
                                    <Border Grid.ColumnSpan="2" Grid.RowSpan="2" x:Name="DropDownBorder" SnapsToDevicePixels="True" Background="Transparent" MaxWidth="{TemplateBinding ActualWidth}" BorderThickness="1" BorderBrush="Black"/>
                                    <ScrollViewer Grid.ColumnSpan="2" ScrollViewer.CanContentScroll="False" Grid.Row="1" SnapsToDevicePixels="True">
                                        <StackPanel IsItemsHost="True" Background="Transparent"/>
                                    </ScrollViewer>
                                </Grid>
                            </Popup>
                        </Grid>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsEditable" Value="true">
                                <Setter Property="IsTabStop" Value="false"/>
                                <Setter  TargetName="PART_EditableTextBox" Property="Background" Value="White"/>
                                <Setter TargetName="PART_EditableTextBox" Property="Visibility" Value="Visible"/>
                                <Setter TargetName="PART_EditableTextBox" Property="Foreground" Value="Black"/>
                                <Setter TargetName="ContentSite" Property="Visibility" Value="Hidden"/>
                            </Trigger>
                            <Trigger Property="HasItems" Value="false">
                                <Setter TargetName="DropDownBorder" Property="MinHeight" Value="95"/>
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="false">
                                <Setter Property="IsTabStop" Value="false"/>
                                <Setter TargetName="PART_EditableTextBox" Property="Visibility" Value="Visible"/>
                                <Setter TargetName="PART_EditableTextBox" Property="Foreground" Value="Black"/>
                                <Setter  TargetName="PART_EditableTextBox" Property="IsEnabled" Value="False"/>
                                <Setter  TargetName="PART_EditableTextBox" Property="Background" Value="White"/>
                                <Setter TargetName="ContentSite" Property="Visibility" Value="Hidden"/>
                            </Trigger>
                            <Trigger Property="IsGrouping" Value="true">
                                <Setter Property="ScrollViewer.CanContentScroll" Value="false"/>
                            </Trigger>
                            <Trigger SourceName="Popup" Property="AllowsTransparency" Value="true">
                                <Setter TargetName="DropDownBorder" Property="Margin" Value="0,2,0,0"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!--$$$$$$$$$$$$$$$$$-              Ð¡Ð’ÐžÐ˜ Ð¡Ð¢Ð˜Ð›Ð˜           -$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$-->


        <Style TargetType="{x:Type controls:MetroTabItem}" >
            <Style.Triggers>
                <Trigger Property="IsSelected" Value="True">
                    <Setter Property="Background" Value="#FFFFCF73"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <Style TargetType="{x:Type TabItem}" >
            <Setter Property="Background" Value="#FFFFCF73"/>
            <Setter Property="FontSize" Value="20"/>
            <Setter Property="FontWeight" Value="Bold"/>
        </Style>

        <LinearGradientBrush StartPoint="0,0" EndPoint="1,1" x:Key="ExpanderGradientbrush">
            <GradientStop Color="BlanchedAlmond" Offset="0"/>
            <GradientStop Color="Blue" Offset="0.2"/>
            <GradientStop Color="BlanchedAlmond" Offset="0.35"/>

            <GradientStop Color="White" Offset="0.65"/>
            <GradientStop Color="Blue" Offset="0.8"/>

            <GradientStop Color="BlanchedAlmond" Offset="1"/>
        </LinearGradientBrush>
    </controls:MetroWindow.Resources>


    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="47*"/>
            <ColumnDefinition Width="151*"/>
        </Grid.ColumnDefinitions>

        <controls:MetroTabControl BorderBrush="#FFFFBE40" BorderThickness="5" controls:TabControlHelper.UnderlineBrush="#FF4573D5" controls:ScrollViewerHelper.IsHorizontalScrollWheelEnabled="True" Grid.ColumnSpan="2" Margin="0,0,-0.4,0.4" >

            <controls:MetroTabItem    Header="Ð’Ñ‹Ñ‡Ð¸ÑÐ»ÐµÐ½Ð¸Ðµ Ð²Ñ‹Ñ€Ð°Ð¶ÐµÐ½Ð¸Ñ"  controls:TabControlHelper.UnderlineMouseOverSelectedBrush="#FF4573D5" >
                <Grid Background="#FF4573D5">

                    <Grid.RowDefinitions>
                        <RowDefinition Height="auto"/>
                        <RowDefinition/>
                    </Grid.RowDefinitions>
                    <Grid  Grid.Row="0" Background="#FF4573D5">
                        <Grid.RowDefinitions>
                            <RowDefinition/>
                            <RowDefinition/>

                        </Grid.RowDefinitions>
                        <Grid Grid.Row="0">
                            <DockPanel Margin="5" LastChildFill="True">
                                <!--<TextBlock Text="Ð’Ñ‹Ñ€Ð°Ð¶ÐµÐ½Ð¸Ðµ" FontSize="16" FontWeight="ExtraBlack" Foreground="Black" DockPanel.Dock="Top"/>-->
                                <Button BorderThickness="3" Content="=" FontSize="40" MinWidth="60" FontWeight="UltraBold" Foreground="#FFFFBE40" FontFamily="Arial" DockPanel.Dock="Right" Click="Button_Click_Compute_Expression" Background="#FF1C0772" BorderBrush="Black"/>
                                <Border BorderBrush="#FFFFBE40" BorderThickness="8">
                                    <TextBox Name="txtBox_Expression"  Padding="10" FontSize="20" FontWeight="UltraBlack" HorizontalContentAlignment="Center"
                                                  Background="White" BorderBrush="#FF110B0B"  CaretBrush="#FF050359" SelectionBrush="#FF2A85AE" Foreground="Black" MaxLength="100" MaxLines="1" IsUndoEnabled="True"  controls:TextBoxHelper.Watermark="Ð’Ð²ÐµÐ´Ð¸Ñ‚Ðµ Ð²Ñ‹Ñ€Ð°Ð¶ÐµÐ½Ð¸Ðµ:A+B"  TextAlignment="Center" controls:TextBoxHelper.WatermarkAlignment="Center" />
                                </Border>
                            </DockPanel>
                        </Grid>

                        <Grid Grid.Row="1">
                            <StackPanel>
                                <!--<TextBlock Padding="0,0,0,3" HorizontalAlignment="Left" FontSize="14"><Run Foreground="Green" Text="âœ…"/><Run Text=" "/><Run FontWeight="DemiBold" Text="ÐžÑˆÐ¸Ð±Ð¾Ðº ÐÐ•Ð¢"/>-->


                                <controls:MetroAnimatedSingleRowTabControl FontFamily="times new roman" Margin="0,0,0,3"  >
                                    <TabItem  Header="Ð’Ñ‹Ð±Ð¾Ñ€ Ð¼Ð°Ñ‚Ñ€Ð¸Ñ†Ñ‹" ToolTip="ÐŸÐ¾Ð¸ÑÐº ÑÑƒÑ‰ÐµÑÑ‚Ð²ÑƒÑŽÑ‰ÐµÐ¹ Ð¼Ð°Ñ‚Ñ€Ð¸Ñ†Ñ‹ Ð´Ð»Ñ Ð¿Ñ€Ð¾ÑÐ¼Ð¾Ñ‚Ñ€Ð°" >
                                        <Border  BorderThickness="3" BorderBrush="#FFFFBE40" Background="#FFFFBE40">
                                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Stretch" VerticalAlignment="Center">
                                                <ComboBox x:Name="ComboBox_orientation" ToolTip="Ð—Ð´ÐµÑÑŒ Ð¼Ð¾Ð¶Ð½Ð¾ Ð²Ñ‹Ð±Ñ€Ð°Ñ‚ÑŒ Ð¾Ñ€Ð¸ÐµÐ½Ñ‚Ð°Ñ†Ð¸ÑŽ" Style="{StaticResource combobox_style}"  MinHeight="50" MinWidth="100" Background="AliceBlue" Margin="5" Foreground="Black" FontSize="16" SelectionChanged="ComboBox_orientation_SelectionChanged" controls:TextBoxHelper.Watermark="sdfsdfsd">
                                                    <ComboBoxItem Content="ÐžÑ€Ð¸ÐµÐ½Ñ‚Ð°Ñ†Ð¸Ñ" FontStyle="Italic" Visibility="Collapsed"/>

                                                    <ComboBoxItem>
                                                        <Image Source="Images\Orientations(minsize) for comboBox\OP2.png"/>
                                                    </ComboBoxItem>
                                                    <ComboBoxItem>
                                                        <Image Source="Images\Orientations(minsize) for comboBox\ÐžÐ .png"/>
                                                    </ComboBoxItem>

                                                    <ComboBoxItem>
                                                        <Image Source="Images\Orientations(minsize) for comboBox\OP4.png"/>
                                                    </ComboBoxItem>

                                                    <ComboBoxItem>
                                                        <Image Source="Images\Orientations(minsize) for comboBox\OP3.png"/>
                                                    </ComboBoxItem>

                                                </ComboBox>

                                                <ComboBox x:Name="ComboBox_common_elts" ToolTip="Ð—Ð´ÐµÑÑŒ Ð¼Ð¾Ð¶Ð½Ð¾ Ð²Ñ‹Ð±Ñ€Ð°Ñ‚ÑŒ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ Ð¾Ð´Ð½Ð¾Ñ‚Ð¸Ð¿Ð½Ð¾Ð³Ð¾ ÑÐ»ÐµÐ¼ÐµÐ½Ñ‚Ð°" Style="{StaticResource combobox_style}" MinHeight="50" MinWidth="100" Background="AliceBlue" Margin="5" Foreground="Black" FontSize="16" SelectionChanged="ComboBox_common_elts_SelectionChanged">
                                                    <ComboBoxItem Content="Ð—Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ Ð¾Ð´Ð½Ð¾Ñ‚Ð¸Ð¿Ð½Ñ‹Ñ… ÑÐ»ÐµÐ¼ÐµÐ½Ñ‚Ð¾Ð²" Foreground="Gray" FontStyle="Italic" Visibility="Collapsed"/>
                                                </ComboBox>

                                                <ComboBox x:Name="comboBox_name" ToolTip="Ð—Ð´ÐµÑÑŒ Ð¼Ð¾Ð¶Ð½Ð¾ Ð²Ñ‹Ð±Ñ€Ð°Ñ‚ÑŒ Ð¸Ð¼Ñ Ð¼Ð°Ñ‚Ñ€Ð¸Ñ†Ð°, ÐºÐ¾Ñ‚Ð¾Ñ€Ð°Ñ Ð·Ð°Ð³Ñ€ÑƒÐ·Ð¸Ñ‚ÑÑ ÑÑ€Ð°Ð·Ñƒ Ð¶Ðµ Ð´Ð»Ñ Ð¿Ñ€Ð¾ÑÐ¼Ð¾Ñ‚Ñ€Ð°" Style="{StaticResource combobox_style}" MinHeight="50" MinWidth="100" Background="AliceBlue" Margin="5" Foreground="Black" FontSize="16" SelectionChanged="comboBox_name_SelectionChanged">
                                                    <ComboBoxItem Content="ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ðµ" FontStyle="Italic" Visibility="Collapsed"/>

                                                </ComboBox>
                                            </StackPanel>
                                        </Border>
                                    </TabItem>


                                    <TabItem Header="Ð˜ÑÑ‚Ð¾Ñ€Ð¸Ñ Ð²Ñ‹Ñ€Ð°Ð¶ÐµÐ½Ð¸Ð¹" ToolTip="Ð—Ð´ÐµÑÑŒ Ð²Ñ‹ Ð¼Ð¾Ð¶ÐµÑ‚Ðµ ÑƒÐ²Ð¸Ð´ÐµÑ‚ÑŒ Ð¸ÑÑ‚Ð¾Ñ€Ð¸ÑŽ Ð²Ð°ÑˆÐ¸Ñ… Ð²Ñ‹Ñ€Ð°Ð¶ÐµÐ½Ð¸Ð¹" >
                                        <DataGrid FontSize="14" FontWeight="Bold" HorizontalAlignment="Left" HorizontalContentAlignment="Left" FontFamily="arial" MaxHeight="100" MinWidth="575" x:Name="DG_Expressions" AutoGenerateColumns="False"  Background="White" BorderBrush="#CCFFFFFF" OpacityMask="#FF21CEA6" >
                                            <!--<ScrollViewer>
                                                <ScrollViewer.Resources>
                                                    <sys:Double x:Key="{x:Static SystemParameters.VerticalScrollBarWidthKey}">100</sys:Double>
                                                </ScrollViewer.Resources>
                                            </ScrollViewer>-->
                                            <DataGrid.Columns>
                                                <DataGridTextColumn Binding="{Binding Number}" Header="â„–" IsReadOnly="True"/>
                                                <DataGridTextColumn Binding="{Binding Expression}" Header="Ð’Ñ‹Ñ€Ð°Ð¶ÐµÐ½Ð¸Ðµ" IsReadOnly="True"/>

                                            </DataGrid.Columns>

                                        </DataGrid>
                                    </TabItem>
                                    <TabItem Header="Ð”Ð¾Ð¿ÑƒÑÑ‚Ð¸Ð¼Ñ‹Ðµ Ð¾Ð¿ÐµÑ€Ð°Ñ†Ð¸Ð¸">
                                        <UniformGrid Columns="4" Rows="1"  VerticalAlignment="Bottom" HorizontalAlignment="Center">
                                            <Button ToolTip="Ð¡Ð»Ð¾Ð¶ÐµÐ½Ð¸Ðµ Ð´Ð²ÑƒÑ… Ð¼Ð°Ñ‚Ñ€Ð¸Ñ†"  Content="âž•"  MaxHeight="400" MaxWidth="400" FontSize="25" BorderBrush="Black" Background="#FFFFBE40" FontWeight="Bold" Click="Button_Click_plus"/>
                                            <Button ToolTip="ÐŸÐ¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ðµ Ð¾Ð±Ñ€Ð°Ñ‚Ð½Ð¾Ð¹ Ð¼Ð°Ñ‚Ñ€Ð¸Ñ†Ñ‹" Content="~" MaxHeight="400" MaxWidth="400" FontSize="25" BorderBrush="Black"  Background="#FFFFBE40"   FontWeight="Bold" Click="Button_Click_inverse"/>
                                            <Button ToolTip="Ð£Ð¼Ð½Ð¾Ð¶ÐµÐ½Ð¸Ðµ Ð´Ð²ÑƒÑ… Ð¼Ð°Ñ‚Ñ€Ð¸Ñ†" Content="âœ•"   MaxHeight="400" MaxWidth="400" FontSize="25" BorderBrush="Black"  Background="#FFFFBE40"  FontWeight="Bold" Click="Button_Click_multiple"/>
                                            <Button ToolTip="Ð’Ñ‹Ñ‡Ð¸Ñ‚Ð°Ð½Ð¸Ðµ Ð´Ð²ÑƒÑ… Ð¼Ð°Ñ‚Ñ€Ð¸Ñ†"  Content="âž–"  MaxHeight="400" MaxWidth="400" FontSize="25" BorderBrush="Black" Background="#FFFFBE40"  FontWeight="Bold" Click="Button_Click_minus"/>
                                        </UniformGrid>
                                    </TabItem>
                                </controls:MetroAnimatedSingleRowTabControl>
                            </StackPanel>
                        </Grid>

                    </Grid>

                    <Grid Grid.Row="1">

                        <Grid.ColumnDefinitions>
                            <ColumnDefinition  Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="auto" />
                            <RowDefinition/>
                        </Grid.RowDefinitions>

                        <Grid   Grid.Row ="0" >
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="1*"/>
                                <ColumnDefinition Width="auto"/>
                                <ColumnDefinition Width="1*"/>

                            </Grid.ColumnDefinitions>

                            <Grid Grid.Column="1">

                                <TextBlock Name="Matrix_name_1st_page"   HorizontalAlignment="Center" VerticalAlignment="Center"  FontSize="28" FontWeight="DemiBold" ><Run Text="Ð—Ð´ÐµÑÑŒ Ð¾Ñ‚Ð¾Ð±Ñ€Ð°Ð·Ð¸Ñ‚ÑÑ Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚ Ð²Ñ‹Ñ‡Ð¸ÑÐ»ÐµÐ½Ð¸Ð¹"/></TextBlock>
                            </Grid>
                            <Grid Grid.Column="2" HorizontalAlignment="Right" Margin="0,0,15,0" >

                                <Button MinWidth="10" Content="ðŸ“‚" FontStretch="UltraCondensed"  ToolTip="Ð¡Ð¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ðµ Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ð°"
                                        FontSize="25" FontWeight="Bold" Background="#FFFFCF73"
                                        Click="Save_Matrix_Dialog" AutomationProperties.IsRequiredForForm="True"/>

                            </Grid>

                        </Grid>

                        <Grid Grid.Row="1">
                            <dg2d:DataGrid2D x:Name="dataGrid2D" FontSize="20" VerticalScrollBarVisibility="Auto" IsReadOnly="True" 
                                             ItemsSource2D="{Binding m_intArray}" Background="#FF4573D5" EnableColumnVirtualization="True" 
                                              UseModifiedDataGridStyle="True" RowBackground="White" AlternatingRowBackground="#ebebeb"  IsManipulationEnabled="True" CanUserReorderColumns="False" CanUserSortColumns="False" MinColumnWidth="100" />

                        </Grid>
                    </Grid>

                </Grid>

            </controls:MetroTabItem>

            <controls:MetroTabItem Header="Ð”Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ Ð¼Ð°Ñ‚Ñ€Ð¸Ñ†Ñ‹" Margin="5,0,0,0 "  >
                <Grid   Background="#FF4573D5">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="auto"/>
                        <ColumnDefinition />
                        <ColumnDefinition Width="auto"/>
                    </Grid.ColumnDefinitions>
                    <Grid Grid.Column="0" MaxWidth="400">
                        <Expander IsExpanded="True" ExpandDirection="Right" BorderThickness="3" Background="{StaticResource ExpanderGradientbrush}" BorderBrush="#FFFFBE40">
                            <Expander.Header>
                                <Label Content="Ð¥Ð°Ñ€Ð°ÐºÑ‚ÐµÑ€Ð¸ÑÑ‚Ð¸ÐºÐ¸ Ð¼Ð°Ñ‚Ñ€Ð¸Ñ†Ñ‹" VerticalAlignment="Center" FontWeight="Bold" FontSize="20" Foreground="Black">
                                    <Label.LayoutTransform>
                                        <RotateTransform Angle="270"/>
                                    </Label.LayoutTransform>
                                </Label>
                            </Expander.Header>

                            <StackPanel>
                                <StackPanel>
                                    <TextBlock Text="Ð ÐµÐ´Ð°ÐºÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ" HorizontalAlignment="Center" FontSize="25" FontWeight="Bold"/>
                                    <Border BorderBrush="Gray" BorderThickness="3">
                                        <StackPanel>
                                            <TextBlock Text="Ð Ð°Ð·Ð¼ÐµÑ€" FontSize="18" FontWeight="Bold"/>
                                            <controls:NumericUpDown x:Name="NumericUpDown" Value="50" FontSize="20" NumericInputMode="Numbers" TrackMouseWheelWhenMouseOver="True" Maximum="100000" Minimum="1" />
                                            <Button Content="Ð¡Ð¾Ð·Ð´Ð°Ñ‚ÑŒ Ð¼Ð°Ñ‚Ñ€Ð¸Ñ†Ñƒ" FontSize="20" FontWeight="Bold" Background="#D2691E" Click="Button_Click_Create_Matrix"/>
                                            <StackPanel Orientation="Horizontal">
                                                <TextBlock Text="ÐžÑ€Ð¸ÐµÐ½Ñ‚Ð°Ñ†Ð¸Ñ:" FontSize="18" FontWeight="Bold" />
                                                <Button Name="Button_Orientation_chnge" Margin="5,5,0,0" Click="Button_Orientation_Click">
                                                    <Image  x:Name="Image_OR" Width="50"/>
                                                </Button>
                                            </StackPanel>
                                            <TextBlock Text="Ð—Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ Ð¾Ð´Ð½Ð¾Ñ‚Ð¸Ð¿Ð½Ñ‹Ñ… ÑÐ»ÐµÐ¼ÐµÐ½Ñ‚Ð¾Ð²:" FontSize="18" FontWeight="Bold"/>
                                            <TextBox x:Name="textBox_typical_elt" Text="0" FontSize="20" MaxLength="50" PreviewTextInput="TextBox_PreviewTextInput" MouseLeave="textBox_typical_elt_MouseLeave" />

                                        </StackPanel>
                                    </Border>
                                </StackPanel>
                                <Border Margin="0,3,0,0" BorderBrush="Gray" BorderThickness="3">
                                    <StackPanel>
                                        <Button Content="ÐÐ²Ñ‚Ð¾ Ð·Ð°Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ðµ" FontSize="20" Background="#FFFFBE40" Click="Button_Click_Auto_Fill"/>
                                        <Button Content="Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ Ð¼Ð°Ñ‚Ñ€Ð¸Ñ†Ñƒ" FontSize="20"  Background="#FFBF7930" Click="Button_Click_Add_To_List"/>
                                        <Button  Content="ÐžÑ‚ÐºÑ€Ñ‹Ñ‚ÑŒ ÑƒÐ¶Ðµ ÑÑƒÑ‰ÐµÑÑ‚Ð²ÑƒÑŽÑ‰ÑƒÑŽ" FontSize="20" Background="#FFFFBE40" Click="Button_Open_existing_Matrix_Click"/>
                                        <Button Content="Ð¡Ð¾Ñ…Ñ€Ð°Ð½Ð¸Ñ‚ÑŒ ÐºÐ°Ðº" FontSize="20" Background="#FFBF7930" Click="Button_save_as_left_expander_Click"/>
                                        <Button Content="Ð£Ð´Ð°Ð»Ð¸Ñ‚ÑŒ Ð¸Ð· ÑÐ¿Ð¸ÑÐºÐ°" FontSize="20" Background="#FFFFBE40" Click="Button_Click_delete_from_Matrix_List"/>

                                    </StackPanel>
                                </Border>
                            </StackPanel>
                        </Expander>
                    </Grid>

                    <Grid Grid.Column="1">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="auto"/>
                            <RowDefinition/>
                            <RowDefinition Height="auto"/>
                        </Grid.RowDefinitions>

                        <Grid Grid.Row="0">
                            <TextBlock Name="Label_Matrix_Name" Text="Ð¡ÐžÐ—Ð”ÐÐ™Ð¢Ð• Ð¸Ð»Ð¸ Ð’Ð«Ð‘Ð•Ð Ð˜Ð¢Ð• Ð¼Ð°Ñ‚Ñ€Ð¸Ñ†Ñƒ" HorizontalAlignment="Center" VerticalAlignment="Center" FontSize="25" FontWeight="ExtraBold"/>
                        </Grid>
                        <Grid Grid.Row="1" >
                            <dg2d:DataGrid2D MinWidth="50" x:Name="dataGrid2D_sec_page" FontSize="20" VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Auto" BorderThickness="0"
                                                 VerticalGridLinesBrush="Black" HorizontalGridLinesBrush="Black" 
                                             Foreground="Black" Background="#FF4573D5" dataGrid2D:Index.StartAt="0"
                                             UseModifiedDataGridStyle="True" RowBackground="White" AlternatingRowBackground="#ebebeb"  EnableColumnVirtualization="True" IsSynchronizedWithCurrentItem="True" AutomationProperties.IsRequiredForForm="True" CanUserReorderColumns="False" CanUserSortColumns="False" MinColumnWidth="100" ClipboardCopyMode="None" ItemStringFormat="" KeyDown="dataGrid2D_sec_page_KeyDown" />
                            <!--<DataGrid >
                                <DataGrid.ItemsSource >
                                    <MultiBinding    Converter="{StaticResource MatrixToDataViewConverter}">
                                        <Binding Path="ColumnHeaders"/>
                                        <Binding Path="RowHeaders"/>
                                        <Binding Path="Values"/>
                                    </MultiBinding>
                                </DataGrid.ItemsSource>
                            </DataGrid>-->
                        </Grid>
                        <Grid Grid.Row="2" Background="#FFFFCF73">

                            <StackPanel  Orientation="Horizontal"  >
                                <TextBlock  Margin="0,0,3,0" FontWeight="Bold" FontSize="20"  Text="ÐŸÑ€ÐµÐ´ÑÑ‚Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ:"/>
                                <controls:MetroAnimatedSingleRowTabControl BorderThickness="0" Background="White">
                                    <TabItem Name="TabItem_Normal_Form" Header="ÐžÐ±Ñ‹Ñ‡Ð½Ð¾Ðµ"  FontSize="19"  controls:ControlsHelper.HeaderFontSize="10" controls:ControlsHelper.HeaderFontWeight="Bold" Background="#FFFFCF73" GotFocus="TabItem_GotFocus_Matrix_Form" />
                                    <TabItem Name="TabItem_Dense_Form" Header="Ð£Ð¿Ð°ÐºÐ¾Ð²Ð°Ð½Ð½Ð¾Ðµ" controls:ControlsHelper.HeaderFontSize="10" controls:ControlsHelper.HeaderFontWeight="Bold" GotFocus="TabItem_GotFocus_Dense_Form"/>
                                    <!--<TabItem Header="Ð¡ Ð°Ð´Ñ€ÐµÑÐ°Ð¼Ð¸" controls:ControlsHelper.HeaderFontSize="10" controls:ControlsHelper.HeaderFontWeight="Bold" PreviewMouseDown="TabItem_PreviewMouseDown_Addresses" GotFocus="TabItem_GotFocus"/>-->
                                </controls:MetroAnimatedSingleRowTabControl>
                            </StackPanel>
                        </Grid>
                    </Grid>

                    <Grid Grid.Column="2" MaxWidth="250">
                        <Expander ExpandDirection="Left" IsExpanded="True" BorderThickness="3" Background="{StaticResource ExpanderGradientbrush}" Foreground="Black" BorderBrush="#FFFFBE40" controls:ScrollViewerHelper.IsHorizontalScrollWheelEnabled="True" Margin="0,0,0,-0.4">
                            <Expander.Header>
                                <Label Content="Ð’Ñ‹Ð±Ð¾Ñ€ Ð¼Ð°Ñ‚Ñ€Ð¸Ñ†Ñ‹" VerticalAlignment="Center" FontSize="20" FontWeight="Bold" Foreground="Black">
                                    <Label.LayoutTransform>
                                        <RotateTransform Angle="90"/>
                                    </Label.LayoutTransform>
                                </Label>
                            </Expander.Header>

                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="AUTO"/>
                                    <RowDefinition/>
                                </Grid.RowDefinitions>
                                <Grid Grid.Row="0">
                                    <TextBox Name="text_box_search" TextWrapping="NoWrap" controls:TextBoxHelper.Watermark="ðŸ”Ž ÐŸÐ¾Ð¸ÑÐº Ð¼Ð°Ñ‚Ñ€Ð¸Ñ†Ñ‹" FontSize="16" SelectionBrush="#FF4573D5" TextChanged="TextBox_TextChanged" MaxLines="1" MaxLength="100" IsUndoEnabled="False"/>

                                </Grid>
                                <Grid Grid.Row="1">
                                    <ListView IsTextSearchEnabled="True"  VerticalContentAlignment="Top" Name="List_Matrices" FontSize="16" OverridesDefaultStyle="False" 
                                               FontWeight="Bold" HorizontalAlignment="Stretch" MouseDoubleClick="List_Matrices_MouseDoubleClick"/>
                                </Grid>

                                <!--<ListBox ScrollViewer.CanContentScroll="False" ScrollViewer.VerticalScrollBarVisibility="Visible" Name="List_Box">
                                </ListBox>-->
                                <!--<ItemsPresenter />-->
                            </Grid>
                            <!--</ListView>-->




                        </Expander>
                    </Grid>





                </Grid>
            </controls:MetroTabItem>

        </controls:MetroTabControl>



    </Grid>



</controls:MetroWindow>
>>>>>>> 783495cba5d256fadce1c336e879ae519320aa31
